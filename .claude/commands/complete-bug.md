# Bug 完了コマンド

指定された Bug チケットを完了としてマークします。

## 使用方法
```
/complete-bug [bug番号]
```

例: `/complete-bug 1` → bug-001 を完了

## 実行手順

### 1. Bug チケットの読み込み
該当する Bug チケットファイルを読み込みます。

### 2. 完了条件の確認
以下の条件をすべて満たしているか確認します：

```markdown
## ✅ 完了条件チェック

- [ ] 修正コードが実装されている
- [ ] TypeScript コンパイルエラーなし
- [ ] ESLint エラーなし
- [ ] localhost で動作確認済み
- [ ] すべてのテストケースをクリア
- [ ] 関連機能に影響がないことを確認
```

すべての条件を満たしていますか？ (y/n)

### 3. ユーザー確認
- `y` の場合: 続行
- `n` の場合: 不足している項目を確認し、処理を中断

### 4. 修正内容の記録
チケットに修正内容を記録します：
```markdown
## 修正内容

### 実施した変更
- `src/components/map/MapView.tsx`: useMemo を使用してマーカーの再レンダリングを最適化
- `src/lib/utils/freshness.ts`: 鮮度計算ロジックをメモ化

### パフォーマンス改善
- Before: 地図表示 10秒
- After: 地図表示 2秒
- 改善率: 80%

### テスト結果
- ✅ 地図表示が3秒以内に完了
- ✅ カフェマーカーが正しく表示
- ✅ パフォーマンスが大幅に改善
```

### 5. ステータスの更新
Bug チケットのステータスを更新します：
```markdown
- 🟢 **Status**: Complete
- **Started**: 2025-10-23 14:30
- **Completed**: 2025-10-23 16:00
- **実績時間**: 1.5時間
```

### 6. Git コミット（修正内容）
修正内容をコミットします：
```bash
git add src/
git commit -m "修正: bug-001 地図の表示が遅い

- MapView コンポーネントの最適化
- マーカー再レンダリングの削減
- 鮮度計算ロジックのメモ化

パフォーマンス: 10秒 → 2秒 (80%改善)"
```

### 7. PROGRESS.md の更新
`docs/ticket/bug/PROGRESS.md` を更新：
- 該当 Bug を「完了」セクションに移動
- 完了日時と所要時間を記録
- 進捗率を再計算
- 平均完了時間を更新

### 8. Git コミット（チケット更新）
チケット更新をコミットします：
```bash
git add docs/ticket/bug/
git commit -m "チケット完了: bug-001 地図の表示が遅い (1.5h)"
```

### 9. 完了メッセージの表示
```markdown
## 🎉 Bug #1 が完了しました！

**タイトル**: 地図の表示が遅い
**所要時間**: 1.5時間
**パフォーマンス改善**: 80%

### 完了した内容
- MapView コンポーネントの最適化
- マーカー再レンダリングの削減
- 鮮度計算ロジックのメモ化

### 更新されたファイル
- チケット: docs/ticket/bug/bug-001-map-display-slow.md
- 進捗: docs/ticket/bug/PROGRESS.md

### 次のアクション
残りの Bug チケット: 5件
- Critical: 1件
- High: 1件
- Medium: 2件
- Low: 1件

次の Bug に取り組むには:
/start-bug [番号]

または、Bug 一覧を確認:
/list-tickets
```

## 重要事項
- **必ず localhost での動作確認が完了していること**
- すべてのテストケースをクリアしていること
- TypeScript と ESLint のエラーがないこと
- 修正内容を詳細に記録すること
- パフォーマンス改善がある場合は数値で記録すること
- 2回のコミット（修正、チケット更新）を必ず実行すること

## エラー時の対応
- Bug が「In Progress」ステータスでない場合: 警告を表示
- 完了条件を満たしていない場合: 不足している項目を指摘
- テストが失敗している場合: 修正を促す
